#!/usr/bin/env pwsh

<#
.SYNOPSIS
    λ°±μ•Ό ν”„λ΅ν† μ½ μ›Ή μΈν„°νμ΄μ¤ μ‹μ‘ μ¤ν¬λ¦½νΈ

.DESCRIPTION
    λ°±μ•Ό ν”„λ΅ν† μ½ λ©”μΈλ„·κ³Ό μ›Ή μΈν„°νμ΄μ¤λ¥Ό ν•¨κ» μ‹μ‘ν•©λ‹λ‹¤.

.EXAMPLE
    .\start-web.ps1
#>

Write-Host @"

π λ°±μ•Ό ν”„λ΅ν† μ½ μ›Ή μΈν„°νμ΄μ¤ μ‹μ‘
β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”
π“ λ©”μΈλ„·κ³Ό μ›Ή μΈν„°νμ΄μ¤λ¥Ό ν•¨κ» μ‹μ‘ν•©λ‹λ‹¤
β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”

"@ -ForegroundColor Cyan

# Node.js λ° npm μ„¤μΉ ν™•μΈ
try {
    $nodeVersion = node --version
    Write-Host "β… Node.js λ²„μ „: $nodeVersion" -ForegroundColor Green
} catch {
    Write-Host "β Node.jsκ°€ μ„¤μΉλμ§€ μ•μ•μµλ‹λ‹¤. Node.jsλ¥Ό λ¨Όμ € μ„¤μΉν•μ„Έμ”." -ForegroundColor Red
    exit 1
}

# ν¨ν‚¤μ§€ μ„¤μΉ μƒνƒ ν™•μΈ
if (-not (Test-Path "node_modules")) {
    Write-Host "π“¦ μμ΅΄μ„± ν¨ν‚¤μ§€ μ„¤μΉ μ¤‘..." -ForegroundColor Yellow
    npm install
    if ($LASTEXITCODE -ne 0) {
        Write-Host "β ν¨ν‚¤μ§€ μ„¤μΉμ— μ‹¤ν¨ν–μµλ‹λ‹¤." -ForegroundColor Red
        exit 1
    }
}

Write-Host @"

π€ λ°±μ•Ό ν”„λ΅ν† μ½ λ©”μΈλ„· μ‹μ‘ μ¤‘...
β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”

"@ -ForegroundColor Green

# ν™κ²½ λ³€μ μ„¤μ •
$env:NODE_ENV = 'production'

# λ©”μΈλ„· μ‹¤ν–‰
Write-Host "π“‹ μ‹¤ν–‰ λ…λ Ήμ–΄: npm run mainnet" -ForegroundColor Cyan
Write-Host ""

# λ©”μΈλ„· μ‹¤ν–‰
npm run mainnet 